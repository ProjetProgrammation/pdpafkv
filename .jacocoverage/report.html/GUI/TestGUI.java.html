<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="fr"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>TestGUI.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JaCoCoverage analysis of project &quot;ProjectProg&quot; (powered by JaCoCo from EclEmma)</a> &gt; <a href="index.source.html" class="el_package">GUI</a> &gt; <span class="el_source">TestGUI.java</span></div><h1>TestGUI.java</h1><pre class="source lang-java linenums">
package GUI;

import BDD.Language;
import Controller.ControllerDatabase;
import Result.User;
import Controller.MediaSelected;
import Controller.SelectMedia;
import Result.Answer;
import Result.Extract;
import javafx.event.ActionEvent;
import javafx.event.EventHandler;
import javafx.geometry.HPos;
import javafx.geometry.Pos;
import javafx.scene.Parent;
import javafx.scene.control.Button;
import javafx.scene.control.Label;
import javafx.scene.control.ProgressBar;
import javafx.scene.layout.BorderPane;
import javafx.scene.layout.GridPane;
import javafx.scene.layout.HBox;
import javafx.stage.Stage;

/**
 * Interface for the real test
 *
 * @author Jeremy
 */
public class TestGUI extends Parent {

    private User userSel;
<span class="nc" id="L32">    private int currentQuestionNumber = 1;</span>
    private final int nbQuestion;
    private final Stage stage;
    private final MediaSelected mediaSel;
    private final SelectMedia selMedia;
    private Language language;
    private ControllerDatabase db;

    /**
     * Constructs a new Scene with the test template.
     *
     * @param stage The interface's stage.
     * @param nbQuestion Number of questions. 
     * @param language User's choice of language.
     * @param db The BDD which contains media.
     * @param user The user who run the application
     */
<span class="nc" id="L49">    public TestGUI(Stage stage, int nbQuestion, Language language, ControllerDatabase db, User user) {</span>
<span class="nc" id="L50">        this.stage = stage;</span>
<span class="nc" id="L51">        this.nbQuestion = nbQuestion;</span>
<span class="nc" id="L52">        this.db = db;</span>
<span class="nc" id="L53">        this.language = language;</span>
<span class="nc" id="L54">        this.selMedia = new SelectMedia(this.db, this.language);</span>
<span class="nc bnc" id="L55" title="All 2 branches missed.">        if (nbQuestion == 5)</span>
<span class="nc" id="L56">            this.mediaSel = new MediaSelected(user, this.language);</span>
        else
<span class="nc" id="L58">            this.mediaSel = null;</span>
<span class="nc" id="L59">        this.launchTestGUI();</span>
<span class="nc" id="L60">    }</span>

    /**
     * 
     * Constructs a new Scene with the test template.
     * 
     * @param stage The stage of the interface.
     * @param nbQuestion The number of questions.
     * @param currentQuestionNumber Current question number.
     * @param selMedia The current entity of selectMedia.
     * @param userSel The user who run the application.
     */
<span class="nc" id="L72">    public TestGUI(Stage stage, int nbQuestion, int currentQuestionNumber, SelectMedia selMedia, User userSel, MediaSelected mediaSelected) {</span>
<span class="nc" id="L73">        this.stage = stage;</span>
<span class="nc" id="L74">        this.nbQuestion = nbQuestion;</span>
<span class="nc" id="L75">        this.currentQuestionNumber = currentQuestionNumber;</span>
<span class="nc" id="L76">        this.selMedia = selMedia;</span>
<span class="nc" id="L77">        this.userSel = userSel;</span>
<span class="nc" id="L78">        this.mediaSel=mediaSelected;</span>
<span class="nc" id="L79">        this.launchTestGUI();</span>
<span class="nc" id="L80">    }</span>
        /**
     *
     * Constructs a new Scene with the test template.
     * 
     * @param primaryStage The stage of the interface.
     * @param nbQuest The number of questions.
     * @param numCourant Current question number.
     * @param selectMedia The current entity of selectMedia.
     * @param mediaSelected The current entity of mediaSelected.
     */
<span class="nc" id="L91">    public TestGUI(Stage primaryStage, int nbQuest, int numCourant, SelectMedia selectMedia, MediaSelected mediaSelected) {</span>
<span class="nc" id="L92">        this.stage = primaryStage;</span>
<span class="nc" id="L93">        this.nbQuestion = nbQuest;</span>
<span class="nc" id="L94">        this.currentQuestionNumber = numCourant;</span>
<span class="nc" id="L95">        this.selMedia = selectMedia;</span>
<span class="nc" id="L96">        this.mediaSel = mediaSelected;</span>
<span class="nc" id="L97">        this.launchTestGUI();</span>
<span class="nc" id="L98">    }</span>
    
<span class="nc" id="L100">     public TestGUI(Stage primaryStage, int nbQuest, int numCourant,SelectMedia selectMedia,Language language,User userSel,ControllerDatabase controller) {</span>
<span class="nc" id="L101">        this.stage = primaryStage;</span>
<span class="nc" id="L102">        this.nbQuestion = nbQuest;</span>
<span class="nc" id="L103">        this.db = controller;</span>
<span class="nc" id="L104">        this.language = language;</span>
<span class="nc" id="L105">        this.userSel = userSel;</span>
<span class="nc" id="L106">        this.currentQuestionNumber = numCourant;</span>
<span class="nc" id="L107">        this.selMedia = selectMedia;</span>
<span class="nc" id="L108">        this.mediaSel = null;</span>
<span class="nc" id="L109">        this.launchTestGUI();</span>
<span class="nc" id="L110">    }</span>

    private void launchTestGUI() {

        //Components design
<span class="nc" id="L115">        final QuestionGUI question = new QuestionGUI(this.selMedia);</span>
<span class="nc" id="L116">        final SonGUI son = new SonGUI(this.selMedia);</span>
<span class="nc" id="L117">        final VideoGUI video = new VideoGUI(this.selMedia);</span>

<span class="nc" id="L119">        Label title = new Label(&quot;Prosodic Adventure&quot;.toUpperCase());</span>
<span class="nc" id="L120">        Label title2 = new Label(&quot;Prosodic Adventure train&quot;.toUpperCase());</span>
        
<span class="nc" id="L122">        Button mix = new Button(&quot;Merge&quot;.toUpperCase());</span>
<span class="nc" id="L123">        Button validate = new Button(&quot;Next&quot;.toUpperCase());</span>

        //Organize the interface
<span class="nc" id="L126">        BorderPane global = new BorderPane();</span>
<span class="nc" id="L127">        GridPane subRoot = new GridPane();</span>
<span class="nc" id="L128">        BorderPane root = new BorderPane();</span>
<span class="nc" id="L129">        HBox questionBox = new HBox(question);</span>
<span class="nc" id="L130">        HBox videoBox = new HBox(video);</span>
<span class="nc" id="L131">        HBox sonBox = new HBox(son);</span>

        //Add style classe
<span class="nc" id="L134">        title.getStyleClass().add(&quot;label-header&quot;);</span>
<span class="nc" id="L135">        title2.getStyleClass().add(&quot;label-header&quot;);</span>
        
        //Barre de progression
<span class="nc" id="L138">        ProgressBar pb = new ProgressBar();</span>
<span class="nc" id="L139">        double progress = (double) 1 / nbQuestion;</span>
<span class="nc" id="L140">        double i = progress * currentQuestionNumber;</span>
<span class="nc" id="L141">        pb.setProgress(i);</span>
<span class="nc" id="L142">        HBox hb = new HBox();</span>
<span class="nc" id="L143">        hb.setSpacing(5);</span>
<span class="nc" id="L144">        hb.setAlignment(Pos.CENTER);</span>
<span class="nc" id="L145">        hb.getChildren().add(pb);</span>

        //Managing events
<span class="nc" id="L148">        validate.setOnAction(new EventHandler&lt;ActionEvent&gt;() {</span>
            @Override
            public void handle(ActionEvent event) {
<span class="nc bnc" id="L151" title="All 4 branches missed.">                if ((video.getVideoSelected() != null) &amp;&amp; (son.getAudioSelected() != null)) {</span>
<span class="nc bnc" id="L152" title="All 4 branches missed.">                    if ((currentQuestionNumber &lt; nbQuestion) &amp;&amp; nbQuestion == 5) {</span>
<span class="nc" id="L153">                        currentQuestionNumber++;</span>
<span class="nc" id="L154">                        mediaSel.addAnswer(new Answer(question.getQuestionSelected(), video.getVideoSelected(), son.getAudioSelected()));</span>
<span class="nc" id="L155">                        new TestGUI(stage,nbQuestion,currentQuestionNumber,selMedia,userSel,mediaSel);</span>
<span class="nc bnc" id="L156" title="All 4 branches missed.">                    }else if ((currentQuestionNumber == nbQuestion) &amp;&amp; nbQuestion == 3) {</span>
<span class="nc" id="L157">                        System.out.println(&quot;[TestGUI]End of train&quot;);</span>
<span class="nc" id="L158">                        new ChooseGUI(stage, language, db, userSel);</span>
<span class="nc bnc" id="L159" title="All 4 branches missed.">                    }else if ((currentQuestionNumber &lt; nbQuestion) &amp;&amp; nbQuestion == 3) {</span>
<span class="nc" id="L160">                        currentQuestionNumber++;</span>
<span class="nc" id="L161">                        new TestGUI(stage, nbQuestion, currentQuestionNumber,selMedia,language, userSel,db);</span>
<span class="nc bnc" id="L162" title="All 4 branches missed.">                    }else if ((currentQuestionNumber == nbQuestion) &amp;&amp; nbQuestion == 5) {</span>
<span class="nc" id="L163">                        System.out.println(&quot;[TestGUI]End of test&quot;);</span>
<span class="nc" id="L164">                        mediaSel.addAnswer(new Answer(question.getQuestionSelected(), video.getVideoSelected(), son.getAudioSelected()));</span>
<span class="nc" id="L165">                        Extract.Extract(mediaSel);</span>
<span class="nc" id="L166">                        new EndGUI(stage);</span>
                    }
                }
<span class="nc" id="L169">            }</span>
        });

<span class="nc" id="L172">        mix.setOnAction(new EventHandler&lt;ActionEvent&gt;() {</span>
            @Override
            public void handle(ActionEvent event) {
                //TODO Mix du son et de la vidéo
                //MediaPlayer.load(&quot;E:\\Document\\NetBeansProject\\ProjectProg\\Video\\2013_3_19_S29_fr_L1_ADMI_B_ok.mp4&quot;);
<span class="nc" id="L177">            }</span>
        });

        //Organize the interface
<span class="nc" id="L181">        questionBox.setAlignment(Pos.CENTER);</span>
<span class="nc" id="L182">        root.setTop(questionBox);</span>
<span class="nc" id="L183">        root.setCenter(subRoot);</span>

<span class="nc" id="L185">        subRoot.add(videoBox, 1, 1);</span>
<span class="nc" id="L186">        subRoot.add(sonBox, 2, 1);</span>
<span class="nc" id="L187">        subRoot.add(mix, 2, 2, 1, 1);</span>
<span class="nc" id="L188">        subRoot.add(validate, 2, 2, 2, 1);</span>
<span class="nc" id="L189">        subRoot.add(pb, 2, 2, 2, 2);</span>
<span class="nc" id="L190">        subRoot.setAlignment(Pos.CENTER);</span>

<span class="nc" id="L192">        GridPane.setHalignment(mix, HPos.CENTER);</span>
<span class="nc" id="L193">        GridPane.setHalignment(validate, HPos.RIGHT);</span>
<span class="nc bnc" id="L194" title="All 2 branches missed.">        if(nbQuestion == 3){</span>
<span class="nc" id="L195">             global.setTop(title2);</span>
        }
        else{
<span class="nc" id="L198">             global.setTop(title);</span>
        }
       
<span class="nc" id="L201">        global.setCenter(root);</span>

        //Add container to the scene
<span class="nc" id="L204">        this.stage.getScene().setRoot(global);</span>

<span class="nc" id="L206">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.4.201502262128</span></div></body></html>